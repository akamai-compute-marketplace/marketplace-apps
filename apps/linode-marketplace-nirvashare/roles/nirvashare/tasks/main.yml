---
- name: nirvashare service and docker
  block:
  - name: Config file Setup
    template:
      src: nirvashare.service
      dest: "/etc/systemd/system/nirvashare.service"

  - name: Create Docker Compose Directory
    file:
     path: /var/nirvashare
     state: directory

  - name: Docker file setup
    template:
      src: docker-compose.yaml
      dest: "/var/nirvashare/docker-compose.yml"

  - name: Reload systemd daemon
    systemd:
      daemon_reload: yes

  - name: Enable nirvashare Service
    systemd:
      name: nirvashare.service
      enabled: yes
      
  - name: Start nirvashare Service
    systemd:
      name: nirvashare.service
      state: started