# Linode MEAN Stack One-Click APP

Deploy a production-ready MEAN (MongoDB, Express.js, Angular, Node.js) stack with built-in security and optimized performance. This setup includes Nginx as a reverse proxy with SSL termination, reducing the load on Node.js and improving security. MongoDB is secured with role-based authentication, featuring an admin user with controlled database access permissions. The Express.js backend comes pre-configured with essential dependencies including cors for cross-origin resource sharing, helmet for enhanced security headers, express-rate-limit for API protection, winston for logging, joi for input validation, and mongoose for MongoDB object modeling.

## Software Included

| Software  | Version   | Description   |
| :---      | :----     | :---          |
| MongoDB   | 8.0       | NoSQL database |
| Express.js| Latest    | Backend web application framework |
| Angular   | Latest    | Frontend JavaScript framework |
| Node.js   | 22.x      | JavaScript runtime environment |
| Nginx     | Latest    | Web server and reverse proxy |

**Supported Distributions:**

- Ubuntu 24.04 LTS

## Linode Helpers Included

| Name  | Action  |
| :---  | :---    |
| Hostname   | The Hostname module uses `dnsdomainname -A` to detect the Linode's FQDN and write to the `/etc/hosts` file. This defaults to the Linode's automatically assigned rDNS. To use a custom FQDN see [Configure your Linode for Reverse DNS](https://www.linode.com/docs/guides/configure-your-linode-for-reverse-dns/).  |
| Update Packages   | The Update Packages module performs apt update and upgrade actions as root.  |
| UFW   | The UFW module will utilize a list generated by `linode_helpers/ufw/ufwgen.yml` in the `group_vars/linode/vars` and enables the service.  |
| Fail2Ban   | The Fail2Ban module installs, activates and enables the Fail2Ban service.  |
| Create DNS Record | The Create DNS Record module creates DNS records for domains and subdomains using the Linode API, including validation of DNS propagation. |
| Secure SSH | The Secure SSH module configures SSH security settings including disabling root login and password authentication when appropriate. |
| SSH Key | The SSH Key module manages SSH key deployment for the sudo user, supporting both custom public keys and account keys. |
| Certbot SSL | The Certbot SSL module handles SSL/TLS certificate installation via Let's Encrypt, supporting Nginx certificate issuance. |

## Use our API

Customers can choose to deploy the MERN stack through the Linode Marketplace or directly using API. Before using the commands below, you will need to create an [API token](https://www.linode.com/docs/products/tools/linode-api/get-started/#create-an-api-token) or configure [linode-cli](https://www.linode.com/products/cli/) on an environment.

Make sure that the following values are updated at the top of the code block before running the commands:
- TOKEN - Your Linode API token
- ROOT_PASS - Root password for the Linode
- USERNAME - System user that will be created
- SOA_EMAIL_ADDRESS - Email address for DNS records
- DOMAIN - Domain name (optional)
- SUBDOMAIN - Subdomain (optional)

```
SHELL:
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export USERNAME="user1"
export SOA_EMAIL_ADDRESS="user@example.com"
export DOMAIN="example.com"
export SUBDOMAIN="www"
curl -H "Content-Type: application/json" \
-H "Authorization: Bearer ${TOKEN}" \
-X POST -d '{
"authorized_users": [
"user1",
"user2"
],
"backups_enabled": true,
"booted": true,
"image": "linode/ubuntu24.04",
"label": "mean-server",
"private_ip": true,
"region": "us-southeast",
"root_pass": "${ROOT_PASS}",
"stackscript_data": {
"user_name": "${USERNAME}",
"disable_root": "Yes",
"token_password": "${TOKEN}",
"subdomain": "${SUBDOMAIN}",
"domain": "${DOMAIN}",
"soa_email_address": "${SOA_EMAIL_ADDRESS}"
},
"stackscript_id": 00000000000,
"type": "g6-nanode-1",
"tags": ["mytag"],
"disk_encryption": "disabled"
}' https://api.linode.com/v4/linode/instances

CLI:
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export USERNAME="user1"
export SOA_EMAIL_ADDRESS="user@example.com"
export DOMAIN="example.com"
export SUBDOMAIN="www"

linode-cli linodes create \
--image 'linode/ubuntu24.04' \
--private_ip true \
--label mean-server \
--root_pass ${ROOT_PASS} \
--booted true \
--stackscript_id 00000000000 \
--stackscript_data '{"user_name": "${USERNAME}","disable_root":"Yes","token_password":"","subdomain":"${SUBDOMAIN}","domain":"${DOMAIN}","soa_email_address":"${SOA_EMAIL_ADDRESS}"}' \
--region us-east \
--type g6-nanode-1 \
--tags mytag \
--authorized_keys "ssh-rsa AAAA_valid_public_ssh_key_123456785== user@their-computer" \
--authorized_users "user1" \
--authorized_users "user2" \
--disk_encryption disabled
```

## Resources

- [Create Linode via API](https://www.linode.com/docs/api/linode-instances/#linode-create)
- [Stackscript reference](https://www.linode.com/docs/guides/writing-scripts-for-use-with-linode-stackscripts-a-tutorial/#user-defined-fields-udfs)
- [MongoDB Documentation](https://docs.mongodb.com/)
- [Express.js Documentation](https://expressjs.com/)
- [Angular Documentation](https://angular.io/docs)
- [Node.js Documentation](https://nodejs.org/docs/latest/api/)