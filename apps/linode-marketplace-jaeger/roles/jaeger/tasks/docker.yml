---
- name: Create Docker volume for Jaeger data
  community.docker.docker_volume:
    name: jaeger_data

- name: Run Jaeger All-in-One container
  community.docker.docker_container:
    name: jaeger
    image: "jaegertracing/all-in-one:{{ app_version }}"
    state: started
    restart_policy: unless-stopped
    ports:
      - "16686:16686"   # Jaeger UI
      - "14268:14268"   # HTTP collector
      - "14250:14250"   # gRPC collector  
      - "4317:4317"     # OTLP gRPC receiver
      - "4318:4318"     # OTLP HTTP receiver
    env:
      COLLECTOR_OTLP_ENABLED: "true"
    volumes:
      - jaeger_data:/tmp
    log_driver: json-file
    log_options:
      max-size: "10m"
      max-file: "3"