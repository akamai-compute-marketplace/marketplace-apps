---
- name: Peppermint Config and Start
  block:
  - name: Configure service file 
    template:
      src: peppermint.service
      dest: "/etc/systemd/system/peppermint.service"
  - name: Create Docker Compose Directory
    file:
      path: /etc/docker/compose/peppermint/
      state: directory
  - name: Create Docker Compose File
    template:
      src: docker-compose.yaml
      dest: "/etc/docker/compose/peppermint/docker-compose.yml"
  - name: Get Docker Compose File
    replace:
      path: /etc/docker/compose/peppermint/docker-compose.yml
      regexp: 'localhost'
      replace: '{{ ansible_default_ipv4.address }}'
  - name: Reload systemd daemon
    systemd:
      daemon_reload: yes
  - name: Enable Peppermint Service
    systemd:
      name: peppermint.service
      enabled: yes
  - name: Start Peppermint Service
    systemd:
      name: peppermint.service
      state: started