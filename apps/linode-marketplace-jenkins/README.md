# Linode Jenkins Deployment One-Click APP

Jenkins is an open source automation tool which can build, test, and deploy your infrastructure. It gives you access to a massive library of plugins to support automation in your projectâ€™s lifecycle. You can create a continuous delivery pipeline which automates the process for getting your software from version control to your users.

## Software Included

| Software  | Version   | Description   |
| :---      | :----     | :---          |
| Jenkins    | 2.464    | Open-source automation server |

**Supported Distributions:**

- Ubuntu 22.04 LTS

## Linode Helpers Included

| Name  | Action  |
| :---  | :---    |
| Hostname   | The Hostname module uses `dnsdomainname -A` to detect the Linode's FQDN and write to the `/etc/hosts` file. This defaults to the Linode's automatically assigned rDNS. To use a custom FQDN see [Configure your Linode for Reverse DNS](https://www.linode.com/docs/guides/configure-your-linode-for-reverse-dns/).  |
| Update Packages   | The Update Packages module performs apt update and upgrade actions as root.  |
| UFW   | The UFW module will utilize a list generated by `linode_helpers/ufw/ufwgen.yml` in the `group_vars/linode/vars` and enables the service.  |
| Fail2Ban   | The Fail2Ban module installs, activates and enables the Fail2Ban service.  |
| Certbot    | Installs Let's Encrypt Certificates on the system for the domain |

## Use our API

Customers can choose to the deploy the Jenkins app through the Linode Marketplace or directly using API. Before using the commands below, you will need to create an [API token](https://www.linode.com/docs/products/tools/linode-api/get-started/#create-an-api-token) or configure [linode-cli](https://www.linode.com/products/cli/) on an environment.

Make sure that the following values are updated at the top of the code block before running the commands:
- TOKEN
- ROOT_PASS

SHELL:
```
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export SOA_EMAIL_ADDRESS="email@domain.com"
export REGION="us-southeast"
export USERNAME="admin"

curl -H "Content-Type: application/json" \
-H "Authorization: Bearer $TOKEN" \
-X POST -d '{
    "authorized_users": [
        "muUser"
    ],
    "backups_enabled": false,
    "booted": true,
    "image": "linode/ubuntu22.04",
    "label": "jenkins-server",
    "private_ip": true,
    "region": "${REGION}",
    "root_pass": "${ROOT_PASS}",
    "stackscript_data": {
        "disable_root": "No",
        "user_name": "${USERNAME}",
        "soa_email_address": "${SOA_EMAIL_ADDRESS}",
        "jenkins_version": "2.464"
    },
    "stackscript_id": 00000000000,
    "tags": ['tag1', 'tag2'],
    "type": "g6-dedicated-4"
}' https://api.linode.com/v4/linode/instances
```

CLI:
```
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export SOA_EMAIL_ADDRESS="email@domain.com"
export REGION="us-southeast"
export USERNAME="admin"

linode-cli linodes create \
  --authorized_users myUser \
  --backups_enabled false \
  --booted true \
  --image 'linode/ubuntu22.04' \
  --label jenkins-server \
  --private_ip true \
  --region us-southeast \
  --root_pass ${ROOT_PASS} \
  --stackscript_data '{"disable_root": "No","user_name":"${USERNAME}","soa_email_address":"${SOA_EMAIL_ADDRESS}","jenkins_version":"2.464"}' \
  --stackscript_id 00000000000 \
  --type g6-dedicated-4
```

## Resources

- [Create Linode via API](https://www.linode.com/docs/api/linode-instances/#linode-create)
- [Stackscript referece](https://www.linode.com/docs/guides/writing-scripts-for-use-with-linode-stackscripts-a-tutorial/#user-defined-fields-udfs)