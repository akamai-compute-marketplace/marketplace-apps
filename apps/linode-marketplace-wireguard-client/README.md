# Linode WireGuard Client One-Click App

Deploy a production-ready WireGuard Client on your Linode in minutes. This app automates the setup of a WireGuard client, configures secure networking, and applies best practices for SSH and system security. It is ideal for connecting your Akamai Compute Instance to a remote WireGuard server for private networking, tunneling, or secure remote access. WireGuard is a simple, fast, modern, and secure VPN that utilizes state-of-the-art cryptography. This One-Click App automatically configures WireGuard with sensible defaults and implements security best practices to help you quickly establish a reliable and secure VPN connection. Clients can be added as peers to your WireGuard Server's `/etc/wireguard/wg0.conf` as they are created.

## Software Included

| Software  | Version   | Description   |
| :---      | :----     | :---          |
| WireGuard  | Latest    | Simple, fast, modern, and secure VPN that utilizes state-of-the-art cryptography |

**Supported Distributions:**

- Ubuntu 24.04 LTS

## Linode Helpers Included

| Name  | Action  |
| :---  | :---    |
| Hostname   | The Hostname module uses `dnsdomainname -A` to detect the Linode's FQDN and write to the `/etc/hosts` file. This defaults to the Linode's automatically assigned rDNS. To use a custom FQDN, see [Configure your Linode for Reverse DNS](https://www.linode.com/docs/guides/configure-your-linode-for-reverse-dns/).  |
| Update Packages   | The Update Packages module performs apt update and upgrade actions as root.  |
| UFW   | The UFW module will utilize a list generated by `linode_helpers/ufw/ufwgen.yml` in the `group_vars/linode/vars` directory and enables the service.  |
| Fail2Ban   | The Fail2Ban module installs, activates, and enables the Fail2Ban service.  |
| Create DNS Record | The Create DNS Record module creates DNS records for domains and subdomains using the Linode API, including validation of DNS propagation. |
| Secure SSH | The Secure SSH module configures SSH security settings, including disabling root login and password authentication when appropriate. |
| SSH Key | The SSH Key module manages SSH key deployment for the sudo user, supporting both custom public keys and account keys. |
| Certbot SSL | The Certbot SSL module handles SSL/TLS certificate installation via Let's Encrypt, supporting Nginx certificate issuance. |

## Use our API

Customers can choose to deploy the WireGuard Client through the Linode Marketplace or directly using the API. Before using the commands below, you will need to create an [API token](https://www.linode.com/docs/products/tools/linode-api/get-started/#create-an-api-token) or configure [linode-cli](https://www.linode.com/products/cli/) in your environment.

Make sure that the following values are updated at the top of the code block before running the commands:
- TOKEN - Your Linode API token
- ROOT_PASS - Root password for the Linode
- USERNAME - System user that will be created
- WIREGUARD_SERVER_PUBLIC_KEY - WireGuard Server Public Key (Base64)
- WIREGUARD_SERVER_ENDPOINT - WireGuard Server Endpoint (IP:51820)
- WIREGUARD_CLIENT_TUNNEL_IP - WireGuard Client Tunnel IP (with /32)
- WIREGUARD_ALLOWED_IPS - Allowed IPs (comma-separated list)

### SHELL

```
# SHELL
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export USERNAME="user1"
export WIREGUARD_SERVER_PUBKEY="Base64 format"
export WIREGUARD_SERVER_ENDPOINT="IP:51820"
export WIREGUARD_CLIENT_IP="10.0.0.2/32"
export WIREGUARD_ALLOWED_IPS="10.0.0.1/32,192.168.1.0/24"
export WIREGUARD_KEEPALIVE="25"

curl -H "Content-Type: application/json" \
-H "Authorization: Bearer ${TOKEN}" \
-X POST -d '{
"image": "linode/ubuntu24.04",
"label": "wireguard-client",
"region": "us-southeast",
"root_pass": "${ROOT_PASS}",
"stackscript_id": 00000000000,
"stackscript_data": {
"user_name": "${USERNAME}",
"disable_root": "Yes",
"wireguard_server_public_key": "${WIREGUARD_SERVER_PUBKEY}",
"wireguard_server_endpoint": "${WIREGUARD_SERVER_ENDPOINT}",
"wireguard_client_tunnel_ip": "${WIREGUARD_CLIENT_IP}",
"wireguard_allowed_ips": "${WIREGUARD_ALLOWED_IPS}"
},
"type": "g6-nanode-1",
"tags": ["mytag"],
"authorized_users": ["user1"],
"private_ip": true,
"booted": true
}' https://api.linode.com/v4/linode/instances

# CLI
export TOKEN="YOUR API TOKEN"
export ROOT_PASS="aComplexP@ssword"
export USERNAME="user1"
export WIREGUARD_SERVER_PUBKEY="in base64 format"
export WIREGUARD_SERVER_ENDPOINT="IP:51820"
export WIREGUARD_CLIENT_IP="10.0.0.2/32"
export WIREGUARD_ALLOWED_IPS="10.0.0.1/32,192.168.1.0/24"
export WIREGUARD_KEEPALIVE="25"

linode-cli linodes create \
  --image 'linode/ubuntu24.04' \
  --private_ip true \
  --label wireguard-client \
  --root_pass ${ROOT_PASS} \
  --booted true \
  --stackscript_id 00000000000 \
  --stackscript_data '{"user_name": "${USERNAME}", "disable_root": "Yes", "wireguard_server_public_key": "${WIREGUARD_SERVER_PUBKEY}", "wireguard_server_endpoint": "${WIREGUARD_SERVER_ENDPOINT}", "wireguard_client_tunnel_ip": "${WIREGUARD_CLIENT_IP}", "wireguard_allowed_ips": "${WIREGUARD_ALLOWED_IPS}"}' \
  --region us-east \
  --type g6-nanode-1 \
  --tags mytag \
  --authorized_users "user1"
```

## Resources

- [Create Linode via API](https://www.linode.com/docs/api/linode-instances/#linode-create)
- [Stackscript reference](https://www.linode.com/docs/guides/writing-scripts-for-use-with-linode-stackscripts-a-tutorial/#user-defined-fields-udfs)
- [WireGuard Documentation](https://www.wireguard.com/)